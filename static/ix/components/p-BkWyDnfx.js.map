{"file":"p-BkWyDnfx.js","mappings":"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","names":["setA11yAttributes"],"sources":["src/components/utils/delegate.ts","src/components/utils/modal/message.ts","src/components/utils/modal/modal.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport type DelegateConfig = {\n  parentElement?: Element;\n};\n\nexport interface FrameworkDelegate {\n  attachView<R = HTMLElement>(view: any, config?: DelegateConfig): Promise<R>;\n  removeView(view: any): Promise<void>;\n}\n\nclass DefaultFrameworkDelegate implements FrameworkDelegate {\n  async attachView<R = HTMLElement>(\n    view: any,\n    config?: DelegateConfig\n  ): Promise<R> {\n    const attachToElement = config?.parentElement ?? document.body;\n    attachToElement.appendChild(view);\n    return view;\n  }\n\n  async removeView(view: any) {\n    view.remove();\n  }\n}\n\nconst coreDelegate = new DefaultFrameworkDelegate();\nlet currentDelegate: FrameworkDelegate = coreDelegate;\n\nexport function registerFrameworkDelegate(delegate: FrameworkDelegate) {\n  currentDelegate = delegate;\n}\n\nexport const resolveDelegate = () => {\n  return currentDelegate;\n};\n\nexport const getCoreDelegate = () => coreDelegate;\n","/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport {\n  iconError,\n  iconInfo,\n  iconQuestion,\n  iconSuccess,\n  iconWarning,\n} from '@siemens/ix-icons/icons';\nimport { getCoreDelegate } from '../delegate';\nimport { TypedEvent } from '../typed-event';\nimport { ModalConfig } from './modal';\n\nexport type MessageConfig<T> = Omit<\n  ModalConfig<T, unknown>,\n  'content' | 'title'\n> &\n  MessageContent;\n\nfunction setA11yAttributes(element: HTMLElement, config: MessageContent) {\n  const ariaDescribedby = config.ariaDescribedby;\n  const ariaLabelledby = config.ariaLabelledby;\n\n  delete config['ariaDescribedby'];\n  delete config['ariaLabelledby'];\n\n  if (ariaDescribedby) {\n    element.setAttribute('aria-describedby', ariaDescribedby);\n  }\n\n  if (ariaLabelledby) {\n    element.setAttribute('aria-labelledby', ariaLabelledby);\n  }\n}\n\nfunction createConfirmButtons(\n  textOkay: string,\n  textCancel?: string,\n  payloadOkay?: any,\n  payloadCancel?: any\n) {\n  let actions: MessageAction[] = [];\n\n  if (textCancel !== undefined) {\n    actions = [\n      ...actions,\n      {\n        id: 'cancel',\n        text: textCancel,\n        type: 'cancel',\n        payload: payloadCancel,\n      } as MessageAction,\n    ];\n  }\n  return [\n    ...actions,\n    {\n      id: 'okay',\n      text: textOkay,\n      type: 'okay',\n      payload: payloadOkay,\n    } as MessageAction,\n  ];\n}\n\nexport type MessageAction = {\n  id: string;\n  type: 'button-primary' | 'button-secondary' | 'okay' | 'cancel';\n  text: string;\n  payload?: any;\n};\n\nexport type MessageContent = {\n  icon: string;\n  iconColor?: string;\n  messageTitle: string;\n  message: string;\n  actions: MessageAction[];\n  ariaLabelledby?: string;\n  ariaDescribedby?: string;\n};\n\nexport async function showMessage<T>(config: MessageConfig<T>) {\n  const onMessageAction = new TypedEvent<{\n    actionId: string;\n    payload: T;\n  }>();\n  const dialog = document.createElement('ix-modal');\n  const header = document.createElement('ix-modal-header');\n  const content = document.createElement('ix-modal-content');\n  const footer = document.createElement('ix-modal-footer');\n\n  setA11yAttributes(dialog, config);\n\n  Object.assign(header, config);\n  Object.assign(content, config);\n  Object.assign(footer, config);\n\n  header.innerText = config.messageTitle;\n  content.innerText = config.message;\n\n  config.actions.forEach(({ id, text, type, payload }) => {\n    const button = document.createElement('ix-button');\n    button.innerText = text;\n    footer.appendChild(button);\n\n    if (type === 'okay') {\n      button.variant = 'primary';\n      button.addEventListener('click', () =>\n        dialog.closeModal({\n          actionId: id,\n          payload,\n        })\n      );\n      return;\n    } else if (type === 'cancel') {\n      button.variant = 'primary';\n      button.outline = true;\n      button.addEventListener('click', () =>\n        dialog.dismissModal({\n          actionId: id,\n          payload,\n        })\n      );\n      return;\n    }\n  });\n\n  dialog.appendChild(header);\n  dialog.appendChild(content);\n  dialog.appendChild(footer);\n\n  const dialogRef =\n    await getCoreDelegate().attachView<HTMLIxModalElement>(dialog);\n\n  dialogRef.addEventListener(\n    'dialogClose',\n    (\n      event: CustomEvent<{\n        actionId: string;\n        payload: T;\n      }>\n    ) => {\n      onMessageAction.emit(event.detail);\n      dialogRef.remove();\n    }\n  );\n\n  dialogRef.addEventListener(\n    'dialogDismiss',\n    (\n      event: CustomEvent<{\n        actionId: string;\n        payload: T;\n      }>\n    ) => {\n      onMessageAction.emit(event.detail);\n      dialogRef.remove();\n    }\n  );\n\n  setA11yAttributes(dialogRef, config);\n  Object.assign(dialogRef, config);\n\n  dialogRef.showModal();\n  return onMessageAction;\n}\n\nshowMessage.info = (\n  title: string,\n  message: string,\n  textOkay: string,\n  textCancel?: string,\n  payloadOkay?: any,\n  payloadCancel?: any\n) => {\n  return showMessage({\n    message,\n    messageTitle: title,\n    icon: iconInfo,\n    actions: createConfirmButtons(\n      textOkay,\n      textCancel,\n      payloadOkay,\n      payloadCancel\n    ),\n  });\n};\n\nshowMessage.warning = (\n  title: string,\n  message: string,\n  textOkay: string,\n  textCancel?: string,\n  payloadOkay?: any,\n  payloadCancel?: any\n) => {\n  return showMessage({\n    message,\n    messageTitle: title,\n    icon: iconWarning,\n    iconColor: 'color-warning',\n    actions: createConfirmButtons(\n      textOkay,\n      textCancel,\n      payloadOkay,\n      payloadCancel\n    ),\n  });\n};\n\nshowMessage.error = (\n  title: string,\n  message: string,\n  textOkay: string,\n  textCancel?: string,\n  payloadOkay?: any,\n  payloadCancel?: any\n) => {\n  return showMessage({\n    message,\n    messageTitle: title,\n    icon: iconError,\n    iconColor: 'color-alarm',\n    actions: createConfirmButtons(\n      textOkay,\n      textCancel,\n      payloadOkay,\n      payloadCancel\n    ),\n  });\n};\n\nshowMessage.success = (\n  title: string,\n  message: string,\n  textOkay: string,\n  textCancel?: string,\n  payloadOkay?: any,\n  payloadCancel?: any\n) => {\n  return showMessage({\n    message,\n    messageTitle: title,\n    icon: iconSuccess,\n    iconColor: 'color-success',\n    actions: createConfirmButtons(\n      textOkay,\n      textCancel,\n      payloadOkay,\n      payloadCancel\n    ),\n  });\n};\n\nshowMessage.question = (\n  title: string,\n  message: string,\n  textOkay: string,\n  textCancel?: string,\n  payloadOkay?: any,\n  payloadCancel?: any\n) => {\n  return showMessage({\n    message,\n    messageTitle: title,\n    icon: iconQuestion,\n    actions: createConfirmButtons(\n      textOkay,\n      textCancel,\n      payloadOkay,\n      payloadCancel\n    ),\n  });\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { IxModalSize } from '../../modal/modal';\nimport { getCoreDelegate, resolveDelegate } from '../delegate';\nimport { TypedEvent } from '../typed-event';\n\nexport function setA11yAttributes(element: HTMLElement, config: ModalConfig) {\n  const ariaDescribedby = config.ariaDescribedby;\n  const ariaLabelledby = config.ariaLabelledby;\n\n  delete config['ariaDescribedby'];\n  delete config['ariaLabelledby'];\n\n  if (ariaDescribedby) {\n    element.setAttribute('aria-describedby', ariaDescribedby);\n  }\n\n  if (ariaLabelledby) {\n    element.setAttribute('aria-labelledby', ariaLabelledby);\n  }\n}\n\nexport interface ModalConfig<TReason = any, CONTENT = any> {\n  animation?: boolean;\n  ariaDescribedby?: string;\n  ariaLabelledby?: string;\n  backdrop?: boolean;\n  closeOnBackdropClick?: boolean;\n  beforeDismiss?: (reason?: TReason) => boolean | Promise<boolean>;\n  centered?: boolean;\n  container?: string | HTMLElement;\n  content: CONTENT | string;\n  keyboard?: boolean;\n  size?: IxModalSize;\n  title?: string;\n}\n\nexport interface ModalInstance<TReason = any> {\n  htmlElement: HTMLIxModalElement;\n  onClose: TypedEvent<TReason>;\n  onDismiss: TypedEvent<TReason>;\n}\n\nfunction getIxModal(element: Element) {\n  return element.closest('ix-modal');\n}\n\nexport function closeModal<TClose = any>(\n  element: Element,\n  closeResult: TClose\n) {\n  const dialog = getIxModal(element);\n  if (dialog) {\n    dialog.closeModal(closeResult);\n    return;\n  }\n}\n\nexport function dismissModal(element: Element, dismissResult?: any) {\n  const dialog = getIxModal(element);\n  if (dialog) {\n    dialog.dismissModal(dismissResult);\n    return;\n  }\n}\n\nexport async function showModal<T>(\n  config: ModalConfig<T>\n): Promise<ModalInstance<T>> {\n  const delegate = resolveDelegate();\n  let dialogRef: HTMLIxModalElement | undefined;\n  const onClose = new TypedEvent<T>();\n  const onDismiss = new TypedEvent<T>();\n\n  if (typeof config.content === 'string') {\n    const dialog = document.createElement('ix-modal');\n    dialog.innerText = config.content;\n    dialogRef = await getCoreDelegate().attachView(dialog);\n  }\n\n  if (\n    config.content instanceof HTMLElement &&\n    config.content.tagName !== 'IX-MODAL'\n  ) {\n    const dialog = document.createElement('ix-modal');\n    dialog.appendChild(config.content);\n    dialogRef = await getCoreDelegate().attachView(dialog);\n  }\n  if (!dialogRef) {\n    dialogRef = await delegate.attachView<HTMLIxModalElement>(config.content);\n  }\n\n  setA11yAttributes(dialogRef, config);\n  Object.assign(dialogRef, config);\n\n  await dialogRef.showModal();\n  dialogRef.addEventListener('dialogClose', async ({ detail }: CustomEvent) => {\n    onClose.emit(detail);\n    await delegate.removeView(dialogRef);\n  });\n\n  dialogRef.addEventListener(\n    'dialogDismiss',\n    async ({ detail }: CustomEvent) => {\n      onDismiss.emit(detail);\n      await delegate.removeView(dialogRef);\n    }\n  );\n\n  requestAnimationFrame(() => {\n    const autofocusElement = dialogRef.querySelector(\n      '[autofocus],[auto-focus]'\n    );\n\n    if (autofocusElement) {\n      (autofocusElement as HTMLIxButtonElement).focus();\n    }\n  });\n\n  return {\n    htmlElement: dialogRef,\n    onClose,\n    onDismiss,\n  };\n}\n"],"version":3}